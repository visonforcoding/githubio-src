---
title: 聊聊微信体系的几大平台
date: 2021-12-08 13:31:53
tags: 编码人生
---


> 当前微信有商户平台、开放平台、微信号(小程序)总共3大平台。跟订阅号、服务号一样，概念名词非常多,极容易弄混。跟其开发文档一样，微信体系被不少开发吐槽很深。

现在就针对微信体系产品平台做一个总结，避免混淆和了解各个概念用途。

<!--more-->

## 平台产品

- 开放平台，`https://open.weixin.qq.com/`
- 公众平台(含小程序) `https://mp.weixin.qq.com/`
- 商户平台 `https://pay.weixin.qq.com/`

## 公众平台

回顾一下微信历史：

- 2011年1月21日，微信正式发布
- 2011年5月，微信推出了"语音消息"这个关键功能
- 2012年5月，微信推出"朋友圈"
- 2013年8月，微信添加了公众号、微信支付
- 2017年1月，小程序的开发指南和 API 正式发布

在13年推出的微信公众号微信支付能力，彼时公众号和微信支付大受欢迎。公众号又分为`服务号`和`订阅号`，订阅号可以说是揭开了自媒体爆发的帷幕。自此可以说中国`自媒体1.0`时代来临，`2.0时代`我认为是抖音、快手等平台的兴起。

- 订阅号主要服务媒体、个人等用于信息发布
- 服务号提供更多的运营能力和自主开发接口能力,适合企业
- 小程序相对于公众号，相比公众号内的H5应用有更好的用户体验和更多的微信提供的接口能力。

![](https://vison-blog.oss-cn-beijing.aliyuncs.com/20211207173256.png)

服务号、订阅号功能区别

![](https://vison-blog.oss-cn-beijing.aliyuncs.com/20211207173717.png)

[腾讯客服官方对于公众号、订阅号的定义区别](https://kf.qq.com/faq/170815aUZjeQ170815mU7bI7.html)

这个链接是老链接了，这里的说法是只有微信认证的服务号才具备微信支付功能。

但是在最新的商户平台公众号接入支付里的介绍是支持订阅号接入支付功能。

![](https://vison-blog.oss-cn-beijing.aliyuncs.com/20211207174558.png)

现在我们了解到了，公众号(服务号、订阅号)、小程序的功能和区别了。

- 如果你是个人自媒体或组织，没有计算机技术开发能力那么你大概需要`订阅号`
- 如果你是企业，有开发能力那么你大概需要的是`服务号`
- 如果你作为企业，又需要更好体验的用微信作为入口的移动应用那么相较于微信内的H5应用你可能更应该选择`小程序`
- 公众号是服务号、订阅号的统称
- 公众号(服务号、订阅号)、小程序管理入口都是 `https://mp.weixin.qq.com`


## 微信支付

在中国,几乎99%的企业应该都会使用到微信支付，所以对接微信支付是企业应用开发者不可避免的工作。

![](https://vison-blog.oss-cn-beijing.aliyuncs.com/20211207184020.png)

其中，

- JSAPI支付
- Native支付
- APP支付
- 小程序支付

都是开发者们会涉及到的可能需要对接的支付方式。

### JSAPI支付

>商户已有H5商城网站，用户通过消息或扫描二维码在微信内打开网页时，可以调用微信支付完成下单购买的流程。

**应用载体：微信浏览器内打开的应用**

从技术角度讲，就是在`微信内打开移动页面`,通过JS(javascript)调用微信的API唤起支付。

**需要注意的是，JSAPI唤起只能是在微信内调用，即JSAPI支付一定是在微信浏览器内触发**

此支付方式场景有：

- 从公众号导航或消息点开的H5网页
- H5网页链接，微信扫码打开


### H5支付

> 要求商户已有H5商城网站，并且已经过ICP备案。通过微信H5支付可以实现在非微信浏览器（如QQ浏览器、谷歌浏览器、Safari等）中使用微信支付的场景。

**应用载体：非微信浏览器打开的H5应用**

[微信官方H5支付介绍](https://pay.weixin.qq.com/wiki/doc/api/H5.php?chapter=15_3)

这种支付已经不能从官方的导航页面找到了，只能从搜索引擎搜索出入口了。

![](https://vison-blog.oss-cn-beijing.aliyuncs.com/20211207195337.png)

我猜想大概也是因为上面说的，官方并不建议这么做。
现在很多企业会考虑将第二曲线业务应用使用H5的方式嵌入到主业务APP内，以达到快速迭代的目的。这样可能的情况就是，一个APP内有多种微信支付方式，`主业务的原生APP支付`和`第二曲线业务的H5支付方式`。

![](https://vison-blog.oss-cn-beijing.aliyuncs.com/20211207200000.png)

起关键的地方在于，使用`deeplink`跳转到微信客户端进行唤起微信支付。

> 统一下单接口返回支付相关参数给商户后台，如支付跳转url（参数名“mweb_url”），商户通过mweb_url调起微信支付中间页

统一下单API接口返回`支付跳转链接	mweb_url`.

mweb_url为拉起微信支付收银台的中间页面，可通过访问该url来拉起微信客户端，完成支付,mweb_url的有效期为5分钟。


### Native支付


> Native支付是指商户系统按微信支付协议生成支付二维码，用户再用微信“扫一扫”完成支付的模式。该模式适用于PC网站、实体店单品或订单、媒体广告支付等场景


Native支付即扫码支付，主要应用场景是在`PC网站应用`通过微信扫描网站生成的带有商品信息的支付二维码进行支付。

**应用载体：企业的PC网站**

### App支付

> APP支付是指商户通过在移动端应用APP中集成开放SDK调起微信支付模块来完成支付。适用于在移动端APP中集成微信支付功能的场景。

**应用载体：企业的APP**

### 小程序支付

> 商户已有微信小程序，用户通过好友分享或扫描二维码在微信内打开小程序时，可以调用微信支付完成下单购买的流程。

类似于JSAPI支付，只是是在小程序内唤起。

**应用载体：微信小程序**


### 小结

- 上述5种支付方式,支付动作都是在微信APP内
- 要么本身业务应用就在微信内,要么是使用微信扫码或者APP跳转到微信
- 所有支付方式都需要调用一个接口`统一下单`,统一下单接口需要2个重要参数`appid`、`mchid`

> 由于微信支付的产品体系全部搭载于微信的社交体系之上，所以直连商户或服务商商户接入微信支付之前，都需要有一个微信社交载体，该载体对应的ID即为APPID。

统一下单所需要的appid即为载体的appid。不同载体需要在不同平台申请appid。 小程序、公众号前往`公众平台`申请,自有APP前往`开放平台`申请

`mchid`是商户ID,是收款账号。需前往`商户平台`申请。

**一个mchid只能对应一个结算币种，若需要使用多个币种收款，需要申请对应数量的mchid。**


微信支付交易发起依赖于公众号、小程序、移动应用（即APPID）与商户号（即MCHID）的绑定关系，因此商户在完成签约后，**需要确认当前商户号同appid的绑定关系，方可使用**。

![](https://vison-blog.oss-cn-beijing.aliyuncs.com/20211207233039.png)

APPID和mchid可以是多对多的绑定关系,同时认证主体也会造成绑定失败。

[appid和mchid绑定指引](https://pay.weixin.qq.com/static/pay_setting/appid_protocol.shtml)

- 同主体绑定可自助处理
- 异主体绑定可能会受资格限定
- 商户号与其他类型账号建立关联关系后，暂不支持解绑
- 绑定的APPID如已有绑定商户号，则发起绑定申请的商户号需与APPID已绑定的`商户号费率`一致

## 第三方平台

在开放平台中可以新建第三方平台应用。

> 微信开放平台-第三方平台（简称第三方平台）开放给所有通过开发者资质认证的开发者使用。在得到公众号或小程序运营者（简称运营者）授权后，第三方平台开发者可以通过调用微信开放平台的接口能力，为公众号或小程序的运营者提供账号申请、小程序创建、技术开发、行业方案、活动营销、插件能力等全方位服务。



![](https://vison-blog.oss-cn-beijing.aliyuncs.com/20211208095207.png)


简而言之是：如果你的企业没有研发能力，可以找此类服务商在获取你的授权后代你去开发一些功能。此类服务商需要首先新建第三方平台。

## 补充

到目前为止，3大平台都已经浮出水面，最后做一个总结补充。

- 公众平台，运营者身份也会参与很多管理工作
- 开放平台，更多是开发者介入,提供无社交载体的APP支付应用创建以及其他的微信扫码登录、第三方平台等功能
- 商户平台，与财务关系紧密，与微信支付功能息息相关
- 第三方平台，与公众号/小程序服务商相关，提供给无研发能力的企业，授权服务商代开发的能力。




